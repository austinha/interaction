---
layout: presentation
title: Lab 02 Events and Layout
description: Introduction to event handling and layout in Android
class: middle, center, inverse
---
name: inverse
layout: true
class: center, middle, inverse
---
template: inverse

# Interactivity Lab (Fall 2018)
## Week 2: Activities, Layout

Instructor: TBD
_{email}_  

Slides online: xxx url

---
layout: false

# Goals for Today
- Peer grade Doodle exercise
- Drawing an Interface in Android
- __Layouts__ - constraints on Android
- Discuss layout assignment
- Work on layout assignment

---
template: inverse

## Peer Grading
---
template: none
---
# Peer Grading Doodle
- XX describe rubric and how to do it.

---
template: inverse

## Android UI Output
---
layout: false

## User Interfaces on Android
- Views

  - Base class for __all__ UI elements

--

  - Controls (switches, sliders, etc)
--

  - UI Components - typical display elements mentioned in SSUI lecture (e.g buttons, labels, image views, etc)
--


- View Groups

  - Encapsulates one or more views (e.g. Android Components, Layouts)

--

  - *Note*: Android Components are self-contained, home-screen-specific display items for apps (e.g. clock/time, weather, email-at-a-glance)
---

.right[# Sample Hierarchy]
.left[
<div class="mermaid">
graph TD
A(ViewGroup) -->  B(ViewGroup)
A --> C(View)
A --> D(View)
B --> E(View)
B --> F(View)
B --> G(View)

classDef blue fill:#7887AB,stroke:#333,stroke-width:6px;

class A,B blue
</div>
]

---
## UI Component Toolbox
- Most Common:
  - __TextView__ - read-only text label

  - __ImageView__ - displays an image

  - __Button__ - push button

  - __RadioButton__ - single-selection button

  - __EditText__ - editable text box

  - And __layouts__...

---
template: inverse

## Android Layout

---

## ViewGroups - Layout Types
- [FrameLayout](https://developer.android.com/reference/android/component/FrameLayout.html) - good for position views on top of each other, or encapsulating a bunch of views

- [__LinearLayout__](https://developer.android.com/reference/android/component/LinearLayout.html) - places views one after the other in order according to the orientation (Horizontal or Vertical)

- [__TableLayout__](https://developer.android.com/reference/android/component/TableLayout.html) - Rows and columns style way of declaring a layout

- [GridLayout](https://developer.android.com/reference/android/component/GridLayout.html) - Uses an [*adapter*](https://developer.android.com/reference/android/interactor/Adapter.html) that provides items to display in a grid

- [ListView](https://developer.android.com/guide/topics/ui/layout/listview.html) - Uses an [*adapter*](https://developer.android.com/reference/android/component/Adapter.html) class that provides items to display in a list

- [__RelativeLayout__](https://developer.android.com/reference/android/component/RelativeLayout.html) - positions views with respect to on another

- [WebView](https://developer.android.com/reference/android/webkit/WebView.html) - uses html/css to layout a page, but requires `INTERNET` permission in your manifest

- More on https://developer.android.com/guide/topics/ui/declaring-layout.html
???
XX TODO GO OVER THESE? or stick to constraints only?
---
template:inverse

## Layout Exercise

XXX TODO decide whether to use [activityFun](https://github.com/mriveralee/ssui-mobile-exercises-2016/tree/master/exercises/lab02/ActivityFun) or something else

---
.center[
  ## Spot the layouts + views

  .four-tenths-width-img[
    ![AnyDo Calendar](img/anydo-example.png)
  ]

]

---
.left-column[
# How Android Draws Views (1/2)
]
.right-column[
When an `Activity` receives focus, Android requests the activity draw its layout
]
--
.right-column[
An activity __must__ provide a root node of the layout hierarchy
]
--
.right-column[
The root node will measure and draw the layout tree
]
---
.left-column[
# How Android Draws Views (2/2)
]
.right-column[
__In-order tree traversal__ is done on the layout hierarchy..
]

--
.right-column[
Each view is responsible for drawing itself before (i.e. __behind__) their children
]
--
.right-column[
Siblings are drawn in the order that they appear  

.center.half-width-img[
  ![Android Drawing](img/view-group.png)
  ]
]
---
.left-column[
# When to (re)Draw?
]
.right-column[
Drawing is costly- (e.g. frame rates dropping for scrolling interactions)
]
--
.right-column[
Often the screen is static
]
--
.right-column[
We should *draw when we need to*
]

--
.right-column[
Re-drawing "damaged" areas: call `invalidate()`
]
---
.left-column[
# The Drawing Process
]
.right-column[
1) Android calls measure on root node (view)
```java
// View specifies size of self
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec);
```
]
--
.right-column[
2) Android calls layout on view
```java
// View specifies size and position of children
protected void onLayout(boolean changed, int left, int top, int right, int bottom);
```
]
--
.right-column[
3) Android calls draw on view
```java
// Add the drawing happens
protected void onDraw(Canvas canvas);
```
]
---
.left-column[
# Measuring
]
.right-column[
`onMeasure()` is a callback invoked by `View.measure()`
]
--
.right-column[
Guidance about the size is given from parent view in the form of `MeasureSpec` parameters
]
--
.right-column[
Ensures every view has a width and height value set prior to a layout pass
]
--
.footnote[
Note: You must manually take padding into account (subtract padding
from the width/height dimensions)
]
---
.left-column[
# Layout
]
.right-column[
`onLayout()` is a callback triggered when a view's position is changed
]
--
.right-column[
Gives the new position __relative__ to the parent
]
--
.right-column[
Causes a layout call on all children (!)
]
